<h3>
    Filters <span 
        class="sup-icon" 
        data-toggle="tooltip" 
        title="Click on a filter label to expand it and see the sub-filters. Click on 'Any' to apply all the sub-filters or click on the sub-filter label to only apply that. The number in the badge indicates how many records are available if that filter is applied.">
        {% include "svgs/solid/info-circle.svg" %}
        </span>
</h3>

<div id="filters" class="mb-2">
    <div
        v-for="facet in facets"
        :key="facet.name"
        class="btn-group"
        role="group"
        aria-label="Grouped filters">
        <button
            v-bind:aria-controls="facet.name" 
            v-bind:class="hasFilter([facet.name]) ? 'btn-info' : ''"
            v-bind:data-target="'#' + facet.name"
            aria-expanded="false"
            class="btn btn-outline-primary btn-sm"
            data-toggle="collapse"
            type="button">{[ getFacetDisplayName(facet.name) ]} 
        </button>
        <button
            v-if="hasAny(facet)"
            v-on:click="updateFilters([facet.name, 'any'])"
            v-bind:class="hasFilter([facet.name, 'any']) ? 'btn-info btn-sm' : 'btn-outline-dark btn-sm'"
            class="btn btn-outline-primary btn-sm"
            type="button">Any
            <span class="badge badge-secondary">{[ getFacetCount(facet.buckets) ]}</span>
            <span class="sr-only">records</span>
        </button>
    </div>

    <div
        v-for="facet in facets"
        :key="facet.name + 'buckets'"
        v-bind:id="facet.name"
        class="alert collapse"
        data-parent="#filters">
        <template v-for="bucket in facet.buckets">
            <button
                v-if="getBucketValue(bucket) !== 'any'"
                v-on:click="updateFilters([facet.name, getBucketValue(bucket)])"
                v-bind:class="hasFilter([facet.name, getBucketValue(bucket)]) ? 'btn-info btn-sm' : 'btn-outline-dark btn-sm'"
                class="filter btn"
                type="button">
                {[ getBucketValue(bucket) ]} 
                <span class="badge badge-secondary">{[ bucket.doc_count ]}</span>
                <span class="sr-only">records</span>
            </button>
        </template>
    </div>
</div>
